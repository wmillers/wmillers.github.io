<!doctype html><html lang=zh><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å†™åœ¨æœ€å‰é¢ï¼šè¿™ä¸ªæ–¹æ¡ˆå‡ºäºæŸäº›åŸå› æš‚æ—¶å¼ƒç”¨ï¼Œè™½ç„¶åŸæœ‰çš„ä¼šå¡ï¼Œä½†æ˜¯smartdnsæ›´å¡ã€‚æ­¤æ–‡ä»…ä½œæµç¨‹å‚è€ƒã€‚ è¿™æ¬¡å°†è·¯ç”±å™¨ä¸Šçš„d"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="è®°å½•ä¸€ä¸‹æˆ‘åœ¨é…ç½®smartdnsä¸Šé‡åˆ°çš„å‘"><meta property="og:description" content="å†™åœ¨æœ€å‰é¢ï¼šè¿™ä¸ªæ–¹æ¡ˆå‡ºäºæŸäº›åŸå› æš‚æ—¶å¼ƒç”¨ï¼Œè™½ç„¶åŸæœ‰çš„ä¼šå¡ï¼Œä½†æ˜¯smartdnsæ›´å¡ã€‚æ­¤æ–‡ä»…ä½œæµç¨‹å‚è€ƒã€‚ è¿™æ¬¡å°†è·¯ç”±å™¨ä¸Šçš„d"><meta property="og:type" content="article"><meta property="og:url" content="https://wmillers.github.io/posts/traps-in-smartdns-on-my-merlin-router/"><meta property="article:published_time" content="2021-01-03T10:30:21+08:00"><meta property="article:modified_time" content="2021-01-26T19:06:20+08:00"><title>è®°å½•ä¸€ä¸‹æˆ‘åœ¨é…ç½®smartdnsä¸Šé‡åˆ°çš„å‘ | æº</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.3f22abb40afc222853ca897b02c941438842d353209e0a4b332b11e17ed16f7b.css integrity="sha256-PyKrtAr8IihTyol7AslBQ4hC01MgngpLMysR4X7Rb3s="><script defer src=/zh.search.min.5103c56899a6de4fb193fe2f49f3625dc9ef79c5d6aff48ed8f5dd72f5574990.js integrity="sha256-UQPFaJmm3k+xk/4vSfNiXcnvecXWr/SO2PXdcvVXSZA="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><script src=/vendor/js/creadcss.min.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav style=color:#555><h2 class=book-brand><a href=/><b style=font-family:simsun,serif;font-size:3.25rem;color:var(--body-font-color)>æº</b></a><div style="font-size:1.25rem;padding:1rem 0">æœˆèƒŒä¹‹åçš„è§æƒ‘</div></h2><div class=book-search><input type=text id=book-search-input placeholder=æœç´¢ aria-label=æœç´¢ maxlength=64 data-hotkeys><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/>å¥‡ç‚¹è·ƒè¿ ğŸ—˜</a></li><li><a href=/archives/>æ—¶é—´èƒ¶å›Š â±</a></li><li><a href=/posts/>èƒŒæ™¯è¾å°„ ğŸ—¯</a></li></ul><small style=position:absolute;margin-top:2rem><p>å…± 5 ç¯‡æ–‡ç«  â‹… 7669 å­—</p><p><a rel=license href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank><img alt=çŸ¥è¯†å…±äº«è®¸å¯åè®® src=/by-nc-sa.svg></a></p><p>Copyright Â© 2020 - 2021<a href=https://github.com/wmillers target=_blank> wmillers</a></p><p><a href=https://gohugo.io/ target=_blank>Hugo</a> é©±åŠ¨ â‹… æ¥è‡ªä¸»é¢˜ <a href=https://github.com/alex-shpak/hugo-book target=_blank>Book</a> é­”æ”¹</p></small></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#è¿›å…¥è·¯ç”±å™¨çš„sshç¯å¢ƒ>è¿›å…¥è·¯ç”±å™¨çš„sshç¯å¢ƒ</a></li><li><a href=#å®‰è£…entware-opkg>å®‰è£…entware (opkg)</a></li><li><a href=#å®‰è£…smartdns>å®‰è£…smartdns</a></li><li><a href=#é…ç½®smartdns>é…ç½®smartdns</a></li><li><a href=#æµ‹è¯•>æµ‹è¯•</a></li><li><a href=#å®Œ>å®Œ</a></li></ul></nav></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>è®°å½•ä¸€ä¸‹æˆ‘åœ¨é…ç½®smartdnsä¸Šé‡åˆ°çš„å‘</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#è¿›å…¥è·¯ç”±å™¨çš„sshç¯å¢ƒ>è¿›å…¥è·¯ç”±å™¨çš„sshç¯å¢ƒ</a></li><li><a href=#å®‰è£…entware-opkg>å®‰è£…entware (opkg)</a></li><li><a href=#å®‰è£…smartdns>å®‰è£…smartdns</a></li><li><a href=#é…ç½®smartdns>é…ç½®smartdns</a></li><li><a href=#æµ‹è¯•>æµ‹è¯•</a></li><li><a href=#å®Œ>å®Œ</a></li></ul></nav></aside></header><article class="markdown with-index"><h1><b><a href=/posts/traps-in-smartdns-on-my-merlin-router/>è®°å½•ä¸€ä¸‹æˆ‘åœ¨é…ç½®smartdnsä¸Šé‡åˆ°çš„å‘</a></b></h1><div style=color:#999><small>æœ€åä¿®æ”¹äº 2021-1-26
<span itemprop=wordCount>æ‰“å­—æœº
1.2k
,</span>
<span itemprop=timeRequired>ç©¿è¶Š3åˆ†é’Ÿ</span></small>
<small>/
<a href=/categories/tutorial/>tutorial</a></small>
<small>/
<a href=/tags/dns/>dns</a>,
<a href=/tags/router/>router</a>,
<a href=/tags/dnsmasq/>dnsmasq</a>,
<a href=/tags/merlin/>merlin</a>,
<a href=/tags/linux/>linux</a></small></div><p><blockquote><p><em><strong>å†™åœ¨æœ€å‰é¢ï¼šè¿™ä¸ªæ–¹æ¡ˆå‡ºäºæŸäº›åŸå› æš‚æ—¶å¼ƒç”¨ï¼Œè™½ç„¶åŸæœ‰çš„ä¼šå¡ï¼Œä½†æ˜¯smartdnsæ›´å¡ã€‚æ­¤æ–‡ä»…ä½œæµç¨‹å‚è€ƒã€‚</strong></em></p></blockquote><blockquote><p>è¿™æ¬¡å°†è·¯ç”±å™¨ä¸Šçš„dnsç”±<code>dnsmasq</code>æ›¿æ¢ä¸º<code>smartdns</code>ä¸»è¦æ˜¯ä¸ºäº†ä½¿ç”¨ dot (dns over TLS)ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ<code>smartdns</code>è¿˜æä¾›äº†å¤šè·¯æŸ¥è¯¢dnsçš„åŠŸèƒ½ã€‚æœ¬æ–‡ä¸»è¦è®°å½•äº†æˆ‘åœ¨éƒ¨ç½²åˆ°æ¢…æ—è·¯ç”±å™¨ä¸Šæ˜¯é‡åˆ°çš„å‘ã€‚<br>å¼€å‘è€…æ•™ç¨‹å’Œæ–‡ä»¶é“¾æ¥ï¼šhttps://github.com/pymumu/smartdns</p></blockquote><h2 id=è¿›å…¥è·¯ç”±å™¨çš„sshç¯å¢ƒ>è¿›å…¥è·¯ç”±å™¨çš„sshç¯å¢ƒ
<a class=anchor href=#%e8%bf%9b%e5%85%a5%e8%b7%af%e7%94%b1%e5%99%a8%e7%9a%84ssh%e7%8e%af%e5%a2%83>#</a></h2><p>åœ¨è·¯ç”±å™¨è®¾ç½®é‡Œæ‰“å¼€sshå¼€å…³ï¼Œæˆ–è€…å’Œæˆ‘ä¸€æ ·ä»è½¯ä»¶ä¸­å¿ƒé‡Œå®‰è£…<code>shellinabox</code>ï¼Œä½¿ç”¨ç½‘é¡µç«¯çš„sshã€‚è¿›å…¥<code>shellinabox</code>åè¾“å…¥è·¯ç”±å™¨å¸å·å’Œå¯†ç ã€‚</p><h2 id=å®‰è£…entware-opkg>å®‰è£…entware (opkg)
<a class=anchor href=#%e5%ae%89%e8%a3%85entware-opkg>#</a></h2><ol><li>ç³»ç»Ÿç®¡ç† > ç³»ç»Ÿè®¾ç½®<br>| Enable SSH | æ˜¯ |<br>| Enable JFFS custom scripts and configs | æ˜¯ |</li><li>åœ¨sshç¯å¢ƒä¸­ï¼š</li></ol><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic>#åˆ›å»ºç›®å½• ä¸æ–‡ä»¶</span>
<span style=color:#204a87>cd</span> /jffs
mkdir /jffs/opt
ln -nsf /jffs/opt /tmp/opt


<span style=color:#8f5902;font-style:italic>#ç¼–è¾‘å¯åŠ¨è„šæœ¬</span>
vi /jffs/scripts/post-mount
	<span style=color:#8f5902;font-style:italic>#!/bin/sh</span>
	ln -nsf /jffs/opt /tmp/opt
chmod a+rx /jffs/scripts/post-mount


<span style=color:#8f5902;font-style:italic>#ä¸‹è½½å®‰è£…è„šæœ¬ å¹¶è¿è¡Œå®‰è£…</span>
wget http://qnapware.zyxmon.org/binaries-armv7/installer/entware_install_arm.sh
 sh ./entware_install_arm.sh

<span style=color:#8f5902;font-style:italic>#å¥½äº†ç°åœ¨å°±å¯ä»¥ç”¨ å‘½ä»¤å®‰è£…äº†</span>
opkg update
opkg install xxxx
</code></pre></td></tr></table></div></div><p>ä¸åŒäºå®˜æ–¹åœ¨<code>Tool</code>ä¸­æä¾›çš„æ–¹æ³•ï¼Œä»¥ä¸Šè„šæœ¬å°†<code>entware</code>å®‰è£…åœ¨æœ¬ä½“çš„<code>jffs</code>é‡Œï¼Œä¸éœ€è¦é¢å¤–çš„uç›˜æŒ‚è½½ã€‚</p><h2 id=å®‰è£…smartdns>å®‰è£…smartdns
<a class=anchor href=#%e5%ae%89%e8%a3%85smartdns>#</a></h2><p><a href=https://github.com/pymumu/smartdns#optwareentware>ä½œè€…æ•™ç¨‹</a> & <a href=https://github.com/pymumu/smartdns/releases/tag/Release33>è½¯ä»¶åŒ…ä¸‹è½½</a><br>æŒ‰ç…§è·¯ç”±å™¨æ¶æ„ (armv7) å’Œå®‰è£…ç¯å¢ƒ (entware/optware) é€‰æ‹©å®‰è£…åŒ…ï¼Œæˆ‘ç”¨çš„æ˜¯<code>smartdns.xxx.arm-optware-all.ipk</code>ã€‚</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#204a87>cd</span> /tmp
wget https://github.com/pymumu/smartdns/releases/download/Release33/smartdns.1.2020.09.08-2235.arm-optware-all.ipk
opkg install /tmp/smartdns.XXX.ipk
</code></pre></td></tr></table></div></div><p>å®‰è£…è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†è·¯ç”±å™¨è¯ä¹¦æœåŠ¡<code>openssl</code>åè®®å¤ªæ—§çš„é—®é¢˜ï¼Œopkgåœ¨å®‰è£…çš„è¿‡ç¨‹ä¸­ä¼šæ ¹æ®ä¾èµ–ä¸‹è½½å…¶ä»–è½¯ä»¶åŒ…ï¼Œç”±äºæœåŠ¡ç«¯åè®®ç‰ˆæœ¬æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥æœ€åæˆ‘è¿˜æ˜¯æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªä¸‹è½½å®‰è£…ä¾èµ–ã€‚</p><h2 id=é…ç½®smartdns>é…ç½®smartdns
<a class=anchor href=#%e9%85%8d%e7%bd%aesmartdns>#</a></h2><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>smartdns</code>å·¥ä½œåœ¨æ¨¡å¼1ï¼Œå³é€šè¿‡iptableså°†53ç«¯å£å‘å‘åŸæœ‰<code>dnsmasq</code>çš„è¯·æ±‚è½¬å‘åˆ°535ç«¯å£ã€‚å·¥ä½œæ¨¡å¼å¯ä»¥é€šè¿‡ä¿®æ”¹<code>/opt/etc/smartdns/smartdns-opt.conf</code>ä¸­<code>SMARTDNS_WORKMODE</code>å‚æ•°æ¥è°ƒæ•´ã€‚</p></blockquote><p>å®‰è£…å®Œæˆå<code>nano /opt/etc/smartdns/smartdns.conf</code>ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p><table><thead><tr><th>ä¿®æ”¹ä¸º</th><th>åŸæœ‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>conf-file smartdns-list.conf</td><td>-</td><td>ä¸Šæ¸¸dnsçš„åœ°å€</td></tr><tr><td>bind :535</td><td>bind [::]:53</td><td>åŸä½œè€…çš„å¯åŠ¨è„šæœ¬æœ‰é—®é¢˜ï¼Œéœ€è¦è¿™é‡Œæ‰‹åŠ¨ä¿®æ”¹</td></tr><tr><td>bind-tcp :535</td><td>-</td><td>åŒä¸Š</td></tr><tr><td>cache-size 40960</td><td>cache-size 4096</td><td>å¦‚æœjffsç©ºé—´ä¸å¤Ÿçš„è¯å¯æ”¹å°</td></tr><tr><td>cache-file /tmp/smartdns.cache</td><td>-</td><td>æš‚å­˜æ–‡ä»¶åº”æ”¾åœ¨ramé‡Œ</td></tr><tr><td>serve-expired yes</td><td>-</td><td>é˜²æ­¢ä¸Šæ¸¸dnså¡é¡¿</td></tr><tr><td>prefetch-domain yes</td><td>-</td><td>è‡ªåŠ¨åˆ·æ–°è¿‡æœŸdns</td></tr><tr><td>force-AAAA-SOA yes</td><td>-</td><td>æœ‰å½±å“ï¼Œæ‰€ä»¥å…ˆå…³é—­ipv6è§£æ</td></tr><tr><td>rr-ttl-min 60</td><td>-</td><td>ä»ä¸Šæ¸¸dnsè¿”å›çš„ttlè‡³å°‘ä¸º60s</td></tr><tr><td>log-level warn</td><td>log-level info</td><td>è¿™ä¸ªå¯ä»¥è¯•å®Œäº†ä»¥åæ”¹</td></tr></tbody></table><p>åœ¨<code>/opt/etc/smartdns/smartdns-list.conf</code>æ·»åŠ ï¼š</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic># server 127.0.0.1 -group lan -exclude-default-group</span>
server 211.140.13.188 
server-tcp 211.140.13.188
server-tls doh.pub                                                                                                                          
<span style=color:#8f5902;font-style:italic># ä»¥ä¸‹è¡Œæ·»åŠ ä½ éœ€è¦ä½¿ç”¨åŸæœ‰dnsmasqè§£æçš„å†…ç½‘dhcpä¿¡æ¯ï¼Œæ›¿æ¢lanX</span>
domain-rules /lanX/ -speed-check-mode none -nameserver lan
<span style=color:#8f5902;font-style:italic># address /lanX/192.168.XX.XX</span>
</code></pre></td></tr></table></div></div><p>å»é™¤åŸå¯åŠ¨è„šæœ¬ä¸­ä¼šé”™è¯¯ä¿®æ”¹ç«¯å£çš„bugï¼Œä¿®æ”¹<code>/opt/etc/init.d/S50smartdns</code>ï¼š</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic># å°† set_smartdns_port() çš„ elif [ &#34;$SMARTDNS_WORKMODE&#34; = &#34;1&#34; ]; then åæ³¨é‡Šæ‰</span>
<span style=color:#8f5902;font-style:italic># sed -i &#34;s/^\\(bind .*\\):53 *\\(.*\\)\$/\\1:$SMARTDNS_PORT \\2/g&#34; $SMARTDNS_CONF                                                                           </span>
<span style=color:#8f5902;font-style:italic># sed -i &#34;s/^\\(bind-tcp .*\\):53 *\\(.*\\)\$/\\1:$SMARTDNS_PORT \\2/g&#34; $SMARTDNS_CONF</span>
<span style=color:#8f5902;font-style:italic># è¿™ä¸¤è¡Œï¼Œå¹¶æ·»åŠ ä¸€è¡Œ</span>
<span style=color:#204a87>echo</span> fix bugs
</code></pre></td></tr></table></div></div><p>åœ¨å¼€æœºå¯åŠ¨è„šæœ¬<code>/jffs/post-mount</code>æ·»åŠ ï¼š</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>/opt/etc/init.d/rc.unslung start
</code></pre></td></tr></table></div></div><p>é‡å¯è·¯ç”±å™¨</p><h2 id=æµ‹è¯•>æµ‹è¯•
<a class=anchor href=#%e6%b5%8b%e8%af%95>#</a></h2><p><code>nslookup -querytype=ptr smartdns</code>æˆ–è€…é€šè¿‡<code>nslookup</code>æŸ¥è¯¢ä»»æ„ä¸€ä¸ªåŸŸåï¼Œå¦‚æœè¿”å›ipåªæœ‰ä¸€ä¸ªï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸã€‚</p><h2 id=å®Œ>å®Œ
<a class=anchor href=#%e5%ae%8c>#</a></h2></p></article><script src=/qrious.min.js></script><script>hasQr=false;function showQr(on){if(on&&!hasQr){(function(){var qr=new QRious({element:document.getElementById('qr'),value:window.location.href});})();hasQr=true;}
document.getElementById('qr').style.display=on?"block":"none";}</script><div class=markdown><blockquote class="book-hint danger" style=margin-top:2rem onmouseover=showQr(true) onmouseout=showQr(false)><canvas id=qr style=position:absolute;right:1rem></canvas>
<small><p class=copyright-item><b>è°ƒæŸ¥å‘˜ :</b>
<span>wmillers</span></p><p>åˆ›å»ºæ—¶é—´ï¼š2021å¹´01æœˆ03æ—¥ - 10æ—¶30åˆ†</p><p>æœ€åä¿®æ”¹ï¼š2021å¹´01æœˆ26æ—¥ - 19æ—¶06åˆ†</p><p class=copyright-item><b>åŒºåŸŸï¼ˆäºŒç»´ç ï¼‰:</b>
<a href=https://wmillers.github.io/posts/traps-in-smartdns-on-my-merlin-router/>https://wmillers.github.io/posts/traps-in-smartdns-on-my-merlin-router/</a></p><b><p class="copyright-item lincese">é‡‡ç”¨<a rel=license href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank>çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯</p></b></small></blockquote></div><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments><span id=/posts/traps-in-smartdns-on-my-merlin-router/ class=leancloud_visitors data-flag-title=è®°å½•ä¸€ä¸‹æˆ‘åœ¨é…ç½®smartdnsä¸Šé‡åˆ°çš„å‘><small><details class=post-meta-item-text><summary>æ—¶ç©ºä¹±æµè®°å½•</summary>
<a href=https://console.leancloud.app/ target=_blank><img src=/90cf159733e558137ed20aa04d09964436f618a1.png style=max-width:27px><small> <span class=leancloud-visitors-count></span>+</small></a></details></small></span><br><div id=vcomments></div><script src=/av-min.js></script><script src=/Valine.min.js></script><script type=text/javascript>setTimeout(function VInit(){new Valine({el:'#vcomments',appId:'O8B7EmkI0g7b1RzB4FtJrXvl-MdYXbMMI',appKey:'KM4TV4SUH6qzz8sN8JWU9tKL',avatar:'retro',placeholder:'æ”¯æŒMarkdownè¯­æ³•ã¤Ï‰âŠ‚',recordIP:true,visitor:true,requiredFields:["mail"],meta:["nick","mail"],emojiCDN:'//i0.hdslb.com/bfs/emote/',emojiMaps:{"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_äº²äº²":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_å·ç¬‘":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_å†è§":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_å†·æ¼ ":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_å‘æ€’":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_å‘è´¢":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_å¯çˆ±":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_åè¡€":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_å‘†":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_å‘•å":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_å›°":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_åç¬‘":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_å¤§ä½¬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_å¤§å“­":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_å§”å±ˆ":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_å®³ç¾":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_å°´å°¬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_å¾®ç¬‘":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_æ€è€ƒ":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_æƒŠå“":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","é›ªæœªæ¥-å¤ªæ£’äº†":"d03c1d062bb4f346c1041ca60bc763d404ddbd56.png","é›ªæœªæ¥-æ‘¸å¤´":"c7389d48b89699ecfeec373f90c8c26ea6d3496b.png","é›ªæœªæ¥-å‡»æŒ":"bd257c4ce22fca6a810c74873e90b343ddcead68.png","é›ªæœªæ¥-ç­‰ä¸€ç­‰":"16e50092a82375171513018f372ed72377fcd979.png","é›ªæœªæ¥-å¿½ç„¶å‡ºç°":"02ba37478cdb287f40b2a328c5755873937cc417.png","é›ªæœªæ¥-å–å¥¶èŒ¶":"7847100be4de8cb3bf25825af165bed4f0668084.png","é›ªæœªæ¥-å†²å‘€":"d5a14055c8b4b457d7d815c79e7e4180299b375d.png","é›ªæœªæ¥-ä¸‹é›ªäº†":"12d2ef42e75d2806bb8a071476e825c58e797f1a.png","é›ªæœªæ¥-å †é›ªäºº":"b2ee932586ee69f1a5ba69676f5fd345b4cd069a.png","é›ªæœªæ¥-èµ–åºŠ":"239d2acb5dc2b96ec98af1ba1a81f49c8b211cd4.png","é›ªæœªæ¥-å¿ä½ä¸ç¬‘":"852cc4cc73caa982b07bcbe48683d20be6c8df61.png","é›ªæœªæ¥-æ‰“æ°”":"1eafe084dccb3c8afff05b21d302e40e06dd07dd.png","é›ªæœªæ¥-å¹æ°”":"a515cd6aa54093c1ccb364f22360620e2d5d76cb.png","é›ªæœªæ¥-ç»™ä½ æƒŠå–œ":"0b552c42157aef2002f8e9c05b06939ac3226127.png","é›ªæœªæ¥-ç”Ÿæ°”":"27e30065621ff3c981102b60865872d1be40fcd7.png","é›ªæœªæ¥-æ—©å®‰":"7d941da6f69bf256b71b2f4c813c9e15bc6f89fa.png","é›ªæœªæ¥-æŒ å¤´":"6c5f3b58a568185b9844e902c632ee5cf362170d.png","é›ªæœªæ¥-å˜¿å˜¿":"7bee0f7af3eef454f9107e883b1c5988fada42a5.png","é›ªæœªæ¥-å”±æ­Œ":"1ac8692986fc4e3d271fa14289f99d5d11dee54d.png","é›ªæœªæ¥-æ³ªç›®":"7d721758533a060933d6cef176012bf15f0fba81.png",}});},1000);</script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><script src=/clipboard.min.js></script><script>(function(){function addCopy(element){var copy=document.createElement("div");copy.className="copy-btn";copy.textContent="å¤åˆ¶";element.prepend(copy);}
var codes=document.querySelectorAll('pre > code');for(var i=0,len=codes.length;i<len;i++)
if(codes[i].className)
addCopy(codes[i].parentElement);new ClipboardJS('.copy-btn',{target:function(trigger){return trigger.nextElementSibling;}}).on('success',function r(e){e.trigger.innerText="å¤åˆ¶æˆåŠŸ";setTimeout(function rtext(){e.trigger.innerText="å¤åˆ¶";},2000);});})();</script></main></body></html>