<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="本文介绍了如何利用 ZIP 压缩中旧的加密算法 zipcrypto 的文件头漏洞来破解压缩包。1 破解要求： 条件 重要性 备注 & 导致无法破解的情况 ZIP 压缩包"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="利用 Zipcrypto 文件头漏洞破解 ZIP 压缩包"><meta property="og:description" content="本文介绍了如何利用 ZIP 压缩中旧的加密算法 zipcrypto 的文件头漏洞来破解压缩包。1 破解要求： 条件 重要性 备注 & 导致无法破解的情况 ZIP 压缩包"><meta property="og:type" content="article"><meta property="og:url" content="https://const.icu/posts/crack-zip-password-with-header/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-04T23:40:48+08:00"><meta property="article:modified_time" content="2021-03-04T07:49:11+08:00"><title>利用 Zipcrypto 文件头漏洞破解 ZIP 压缩包 | 源</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6c31b43d7883d1bc8fd6db57743448160006db9c4e01b92e33446ebebe8333b8.css integrity="sha256-bDG0PXiD0byP1ttXdDRIFgAG25xOAbkuM0Ruvr6DM7g="><script defer src=/zh.search.min.f7e827b32b1995cfd8a308771914df4fe7ad6494f1c2af70399b750ee8ce84f5.js integrity="sha256-9+gnsysZlc/Yowh3GRTfT+etZJTxwq9wOZt1DujOhPU="></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk="></script><script src=/creadcss.min.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav style=color:#555><h2 class=book-brand><a href=/><b style=font-family:simsun,serif;font-size:3.25rem;color:var(--body-font-color)>源</b></a><div style="font-size:1.25rem;padding:1rem 0">月背荧惑</div></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/posts/>奇点 🗘</a></li><li><a href=/archives/>时间胶囊 ⏱</a></li><li><a href=/posts/documents/>背景辐射 🗯</a></li></ul><small style=position:absolute;margin-top:2rem><p>共 13 篇文章 ⋅ 13009 字</p><p><a rel=license href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank><img alt=知识共享许可协议 src=/by-nc-sa.svg></a></p><p>Copyright © 2021 <a href=https://const.icu target=_blank>S</a></p><p>魔改驱动自 Book 主题</p></small></nav><script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#破解>破解</a><ul><li><a href=#下载工具>下载工具</a></li><li><a href=#猜测文件头>猜测文件头</a></li><li><a href=#使用工具>使用工具</a></li><li><a href=#处理结果>处理结果</a></li></ul></li><li><a href=#附录>附录</a><ul><li><a href=#其他格式文件头>其他格式文件头</a></li><li><a href=#链接>链接</a></li></ul></li></ul></nav></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>利用 Zipcrypto 文件头漏洞破解 ZIP 压缩包</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#破解>破解</a><ul><li><a href=#下载工具>下载工具</a></li><li><a href=#猜测文件头>猜测文件头</a></li><li><a href=#使用工具>使用工具</a></li><li><a href=#处理结果>处理结果</a></li></ul></li><li><a href=#附录>附录</a><ul><li><a href=#其他格式文件头>其他格式文件头</a></li><li><a href=#链接>链接</a></li></ul></li></ul></nav></aside></header><article class="markdown with-index"><h1><b><a href=/posts/crack-zip-password-with-header/>利用 Zipcrypto 文件头漏洞破解 ZIP 压缩包</a></b></h1><div style=color:#999><small>最后修改于 2021-3-4
<span itemprop=wordCount>⋅ 打字机
1.1k
⋅</span>
<span itemprop=timeRequired>穿越3分钟</span></small>
<small>/
<a href=/categories/tutorial/>tutorial</a></small>
<small>/
<a href=/tags/%E5%AF%86%E9%92%A5%E7%A2%B0%E6%92%9E/>密钥碰撞</a>,
<a href=/tags/zip%E5%8E%8B%E7%BC%A9%E5%8C%85/>ZIP压缩包</a>,
<a href=/tags/%E5%AF%86%E7%A0%81/>密码</a>,
<a href=/tags/%E5%AE%89%E5%85%A8/>安全</a></small></div><p><blockquote><p>本文介绍了如何利用 ZIP 压缩中旧的加密算法 <code>zipcrypto</code> 的文件头漏洞来破解压缩包。<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>破解要求：</p><table><thead><tr><th>条件</th><th>重要性</th><th>备注 & 导致无法破解的情况</th></tr></thead><tbody><tr><td>ZIP 压缩包且采用 <code>Zipcrypto</code> 算法加密</td><td>必需</td><td>如果算法采用的另外一种 <code>AES-256</code>，则不存在该漏洞，无法破解。早期（2015年前后）的压缩软件默认情况下用的是旧的加密算法。</td></tr><tr><td>目标文件的压缩方法是 <code>Store</code> 仅存储</td><td>只知道文件头情况下必需</td><td>如果用的是 <code>Deflate</code> 压缩，要破解整个压缩包，则需要拥有压缩包内同样的一个文件，将该文件也用 <code>Deflate</code> 压缩后才能用 <code>pkcrack</code> 破解。</td></tr><tr><td>压缩包内的某一个文件的文件头存在固定格式</td><td>至少12字节</td><td>已知的字节至少有8个是连续的，剩余字节可以不连续，如果总计小于12个字节则无法破解。</td></tr></tbody></table><p>例如，ZIP 压缩包内套 ZIP 压缩包，内部的这个压缩包头部是可以猜测得到；XML/PNG 等等文件有固定头部。不过一般情况下除非文件比较小，压缩的时候因为压缩率不高而仅存储，大部分时候同时满足固定文件头和<code>Store</code>两个条件的文件一般都是压缩包或者比较小的图片文件。</p><h2 id=破解>破解
<a class=anchor href=#%e7%a0%b4%e8%a7%a3>#</a></h2><p>如果要破解的压缩包符合上表的条件，则可以破解。要破解的压缩包包括如下文件：</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>1.zip:
文件名     属性 加密 算法
flag.zip    A   +  Zipcrypto Store
other.txt   A   +  Zipcrypto Deflate
</code></pre></td></tr></table></div></div><h3 id=下载工具>下载工具
<a class=anchor href=#%e4%b8%8b%e8%bd%bd%e5%b7%a5%e5%85%b7>#</a></h3><p><a href=https://github.com/kimci86/bkcrack/releases>kimci86/bkcrack</a></p><h3 id=猜测文件头>猜测文件头
<a class=anchor href=#%e7%8c%9c%e6%b5%8b%e6%96%87%e4%bb%b6%e5%a4%b4>#</a></h3><blockquote><p><a href=https://blog.csdn.net/a200710716/article/details/51644421>参考</a></p></blockquote><p>ZIP 压缩包文件头存在固定内容，其余还有几位我们可以猜测出来。</p><table><thead><tr><th>偏移</th><th>内容</th><th>其他可能</th><th>作用</th></tr></thead><tbody><tr><td>0</td><td>504B 0304</td><td></td><td>ZIP 固定文件头</td></tr><tr><td>-</td><td>1400</td><td>0A00</td><td>pkware 最低版本</td></tr><tr><td>-</td><td>0000</td><td>0100</td><td>通用比特标志</td></tr><tr><td>-</td><td>0800</td><td>0000</td><td>08代表 <code>Deflate</code> 压缩</td></tr><tr><td>27</td><td>00</td><td></td><td>文件名长度的后一字节</td></tr><tr><td>28</td><td>0000</td><td></td><td>扩展区长度</td></tr></tbody></table><p>根据上表，偏移0～9共10个字节是连续的符合最低8连续字节要求，再加上27～29共3个字节合计13个字节符合最低12字节的要求，因此只要猜测出其中不确定的位，最多试 <code>2^3=8</code> 次即可完成破解。<br>在我的实验里，以下两种文件头的可能性比较大：</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>   0    2    4    6    8 9
: 504B 0304 1400 0000 0800 # flag压缩包内的文件是 Deflate 压缩的
: 504B 0304 0A00 0000 0000
</code></pre></td></tr></table></div></div><h3 id=使用工具>使用工具
<a class=anchor href=#%e4%bd%bf%e7%94%a8%e5%b7%a5%e5%85%b7>#</a></h3><p>以 <code>Win10</code> 平台为例，下载完成后解压缩进入工具目录。使用 <code>WinHex</code> 或者 <code>Sublime</code> 等等软件将0～9这10个字节新建为 header10 文件。将要破解的压缩包复制入工具的目录。运行以下命令：</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch># bkcrack 
# -C 要破解的压缩包
# -c 内部Store存储的压缩包
# -p 已知至少连续8字节的二进制文件
# -o 该连续字节初始偏移
# -x 其他字节的偏移 其他字节
bkcrack -C 1.zip -c flag.zip -p header10 -o 0 -x 27 000000
</code></pre></td></tr></table></div></div><p>如果输出结果为未找到密钥，则按照表中其他可能更换连续二进制文件中的字节，重复运行，直到返回结果。</p><h3 id=处理结果>处理结果
<a class=anchor href=#%e5%a4%84%e7%90%86%e7%bb%93%e6%9e%9c>#</a></h3><p>完成破解后， <code>bkcrack</code> 会返回 ZIP 压缩包中用于加密的密钥，将密钥填入以下命令，解密该压缩包中其他的文件：</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch># bkcrack -C 原压缩包 -c 要解密的文件 -k 3个密钥 -d 输出的文件名
bkcrack -C 1.zip -c other.txt -k 90b134ed 50e46dd5 af8c8730 -d other.deflate.txt
</code></pre></td></tr></table></div></div><p>因为该文本文件是经过 Deflate 压缩的，所以解密得到的文件还要经过 <code>bkcrack/tool</code> 内的 <code>inflate.py </code>脚本处理。</p><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch>python3 inflate.py <span style=color:#000;font-weight:700>&lt;</span> other.deflate.txt <span style=color:#000;font-weight:700>&gt;</span> other.txt
</code></pre></td></tr></table></div></div><h2 id=附录>附录
<a class=anchor href=#%e9%99%84%e5%bd%95>#</a></h2><h3 id=其他格式文件头>其他格式文件头
<a class=anchor href=#%e5%85%b6%e4%bb%96%e6%a0%bc%e5%bc%8f%e6%96%87%e4%bb%b6%e5%a4%b4>#</a></h3><div class=highlight><div style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>RAR: 5261 7221 1a07 00cf 9073 0000 0d00 0000  Rar!.....s...... # &lt; 5.0
PNG: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR # itself deflated
</code></pre></td></tr></table></div></div><p>其他例如 EXE/XML/HTML 等等都可能有足够12字节的固定文件头。</p><h3 id=链接>链接
<a class=anchor href=#%e9%93%be%e6%8e%a5>#</a></h3><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://www.freebuf.com/articles/network/255145.html>参考资料</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></p></article><script src=/qrious.min.js></script><script>hasQr=!1;function showQr(a){a&&!hasQr&&(function(){var a=new QRious({element:document.getElementById('qr'),value:window.location.href})}(),hasQr=!0),document.getElementById('qr').style.display=a?"block":"none"}</script><div class=markdown><blockquote class="book-hint danger" style=margin-top:2rem onmouseover=showQr(!0) onmouseout=showQr(!1)><canvas id=qr style=position:absolute;right:1rem></canvas>
<small><p class=copyright-item><b>调查员：</b>S</p><p>创建时间：2021年02月04日 - 23时40分</p><p>最后修改：2021年03月04日 - 07时49分</p><p class=copyright-item><b>区域（二维码）：</b>
<a title=返回顶部 href=https://const.icu/posts/crack-zip-password-with-header/#>https://const.icu/posts/crack-zip-password-with-header/↩︎</a></p><b><p class="copyright-item lincese">采用<a rel=license href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可</p></b></small></blockquote></div><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments><span id=/posts/crack-zip-password-with-header/ class=leancloud_visitors data-flag-title="利用 Zipcrypto 文件头漏洞破解 ZIP 压缩包"><small><details class=post-meta-item-text><summary>时空乱流记录</summary>
<a href=https://console.leancloud.app/ target=_blank><img src=/90cf159733e558137ed20aa04d09964436f618a1.png style=max-width:27px><small> <span class=leancloud-visitors-count></span>+</small></a></details></small></span><br><div id=vcomments></div><script src=/av-min.js></script><script src=/Valine.min.js></script><script type=text/javascript>setTimeout(function(){new Valine({el:'#vcomments',appId:'O8B7EmkI0g7b1RzB4FtJrXvl-MdYXbMMI',appKey:'KM4TV4SUH6qzz8sN8JWU9tKL',avatar:'retro',placeholder:'支持Markdown语法 つω⊂',recordIP:!0,visitor:!0,requiredFields:["mail"],meta:["nick","mail"],emojiCDN:'//i0.hdslb.com/bfs/emote/',emojiMaps:{tv_doge:"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","雪未来-太棒了":"d03c1d062bb4f346c1041ca60bc763d404ddbd56.png","雪未来-摸头":"c7389d48b89699ecfeec373f90c8c26ea6d3496b.png","雪未来-击掌":"bd257c4ce22fca6a810c74873e90b343ddcead68.png","雪未来-等一等":"16e50092a82375171513018f372ed72377fcd979.png","雪未来-忽然出现":"02ba37478cdb287f40b2a328c5755873937cc417.png","雪未来-喝奶茶":"7847100be4de8cb3bf25825af165bed4f0668084.png","雪未来-冲呀":"d5a14055c8b4b457d7d815c79e7e4180299b375d.png","雪未来-下雪了":"12d2ef42e75d2806bb8a071476e825c58e797f1a.png","雪未来-堆雪人":"b2ee932586ee69f1a5ba69676f5fd345b4cd069a.png","雪未来-赖床":"239d2acb5dc2b96ec98af1ba1a81f49c8b211cd4.png","雪未来-忍住不笑":"852cc4cc73caa982b07bcbe48683d20be6c8df61.png","雪未来-打气":"1eafe084dccb3c8afff05b21d302e40e06dd07dd.png","雪未来-叹气":"a515cd6aa54093c1ccb364f22360620e2d5d76cb.png","雪未来-给你惊喜":"0b552c42157aef2002f8e9c05b06939ac3226127.png","雪未来-生气":"27e30065621ff3c981102b60865872d1be40fcd7.png","雪未来-早安":"7d941da6f69bf256b71b2f4c813c9e15bc6f89fa.png","雪未来-挠头":"6c5f3b58a568185b9844e902c632ee5cf362170d.png","雪未来-嘿嘿":"7bee0f7af3eef454f9107e883b1c5988fada42a5.png","雪未来-唱歌":"1ac8692986fc4e3d271fa14289f99d5d11dee54d.png","雪未来-泪目":"7d721758533a060933d6cef176012bf15f0fba81.png"}})},1e3)</script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><script src=/clipboard.min.js></script><script>(function(){var b,a,c;function d(b){var a=document.createElement("div");a.className="copy-btn",a.textContent="复制",b.prepend(a)}b=document.querySelectorAll('pre > code');for(a=0,c=b.length;a<c;a++)b[a].className&&d(b[a].parentElement);new ClipboardJS('.copy-btn',{target:function(a){return a.nextElementSibling}}).on('success',function(a){a.trigger.innerText="复制成功",setTimeout(function(){a.trigger.innerText="复制"},2e3)})})()</script></main></body></html>