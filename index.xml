<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>源</title><link>//wmillers.github.io/</link><description>Recent content on 源</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><copyright>wmillers</copyright><lastBuildDate>Sat, 18 Jul 2020 00:05:26 +0800</lastBuildDate><atom:link href="//wmillers.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>自签 CA 和服务器证书命令合集</title><link>//wmillers.github.io/posts/self-signed-ca-server-cert/</link><pubDate>Sat, 18 Jul 2020 00:05:26 +0800</pubDate><guid>//wmillers.github.io/posts/self-signed-ca-server-cert/</guid><description>源 //wmillers.github.io/posts/self-signed-ca-server-cert/ -&lt;p>旧的自签CA以及服务器证书生成的命令合集，总的流程是:&lt;/p>
&lt;h2 id="cakeycacrt">CA.key+CA.crt&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> &lt;span style="color:#75715e">#服务器端私钥和CA证书生成&lt;/span>
openssl req -x509 -newkey rsa:4096 -new -nodes -sha256 -days &lt;span style="color:#ae81ff">36500&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -keyout CA.key -out CA.crt &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -subj &lt;span style="color:#e6db74">&amp;#39;/CN=Used for LAN - ROOT/O=Ab&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -config &amp;lt;&lt;span style="color:#f92672">(&lt;/span>cat /etc/ssl/openssl.cnf - &lt;span style="color:#e6db74">&amp;lt;&amp;lt;END
&lt;/span>&lt;span style="color:#e6db74"> [ x509_ext ]
&lt;/span>&lt;span style="color:#e6db74"> basicConstraints = critical,CA:true
&lt;/span>&lt;span style="color:#e6db74"> subjectKeyIdentifier = hash
&lt;/span>&lt;span style="color:#e6db74"> authorityKeyIdentifier = keyid:always,issuer
&lt;/span>&lt;span style="color:#e6db74">END&lt;/span>
&lt;span style="color:#f92672">)&lt;/span> -extensions x509_ext
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="serverkeyservercsr">server.key+server.csr&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> openssl req -new -out server.csr -keyout server.key &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -newkey rsa:4096 -nodes -sha256 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -subj &lt;span style="color:#e6db74">&amp;#34;/C=US/ST=/L=/O=Ab/OU=/CN=Debian10&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="servercrt">server.crt&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> openssl x509 -req -days &lt;span style="color:#ae81ff">3650&lt;/span> -CA CA.crt -CAkey CA.key -CAcreateserial &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -extensions SAN &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -extfile &amp;lt;&lt;span style="color:#f92672">(&lt;/span>cat /etc/ssl/openssl.cnf &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> &amp;lt;&lt;span style="color:#f92672">(&lt;/span>printf &lt;span style="color:#e6db74">&amp;#34;\n[SAN]\nsubjectAltName=DNS:Debian10,IP:192.168.51.24,IP:192.168.51.112,IP:192.168.51.118&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -in server.csr -out server.crt
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="serverpfx">server.pfx&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> &lt;span style="color:#75715e"># Make a package&lt;/span>
openssl pkcs12 -export -out server.pfx -inkey server.key -in server.crt -certfile CA.crt
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="optional-userkeyusercsr--usercrtuserpfx">Optional: user.key+user.csr&amp;ndash;&amp;gt;user.crt+user.pfx&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> &lt;span style="color:#75715e">#客户端生成 生成csr是为了公钥&lt;/span>
openssl req -new -keyout user.key -out user.csr -newkey rsa:4096 -sha256 -nodes -subj &lt;span style="color:#e6db74">&amp;#39;/CN=Used for LAN/O=Ab&amp;#39;&lt;/span>
openssl x509 -req -days &lt;span style="color:#ae81ff">3650&lt;/span> -in user.csr -CA CA.crt -CAkey CA.key -CAcreateserial -out user.crt
openssl pkcs12 -export -out user.pfx -inkey user.key -in user.crt -certfile CA.crt
&lt;/code>&lt;/pre>&lt;/div>- //wmillers.github.io/posts/self-signed-ca-server-cert/ - wmillers</description></item><item><title>用 Nginx 反代降低暴露 RDP 和 IIS 端口带来的风险</title><link>//wmillers.github.io/posts/docker-guacamole-rdp/</link><pubDate>Mon, 13 Jul 2020 18:49:37 +0800</pubDate><guid>//wmillers.github.io/posts/docker-guacamole-rdp/</guid><description>源 //wmillers.github.io/posts/docker-guacamole-rdp/ -&lt;p>Windows 远程桌面服务作为开放给外网的高权限系统组件存在很大的安全隐患，因此如果需要使用 RDP 服务，最好不要直接开放其对应的 3389 端口，而是通过&lt;code>Remote Desktop Gateway&lt;/code>这个默认存在于rdp客户端的认证通道或者是通过代理来避免端口直接暴露。以上两种方式前者较麻烦，后者则造成每次连接远程桌面都要开启代理，都不太方便。本文介绍如何用&lt;code>Nginx&lt;/code>反向代理减少暴露额外的端口带来的安全风险。&lt;code>Nginx&lt;/code>监听 443 端口传入的 HTTPS 协议内容，并按路径转发给 Docker 中的&lt;code>Guacamole&lt;/code>和 Hyper-v VM 外的 IIS 服务端。&lt;code>Guacamole&lt;/code>将宿主机的 RDP 服务转换成 HTML5 内容，不再需要服务端和向局域网开放 3389 端口。&lt;/p>
&lt;p>本文搭建的环境和程序如下&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Environment&lt;/th>
&lt;th>Contains&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Windows&lt;/td>
&lt;td>Hyper-v, IIS Webserver 10.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Hyper-v (VM)&lt;/td>
&lt;td>Debian 10 (Buster)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Debian 10&lt;/td>
&lt;td>Docker, Nginx 1.14.2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Docker&lt;/td>
&lt;td>Apache Guacamole 1.2.0&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>按外部访问流程排序&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Program&lt;/th>
&lt;th>Usage&lt;/th>
&lt;th>Env&lt;/th>
&lt;th>Protocol&lt;/th>
&lt;th>Address&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Nginx&lt;/td>
&lt;td>HTTPS reverse proxy&lt;/td>
&lt;td>Hyper-v&lt;/td>
&lt;td>HTTPS&lt;/td>
&lt;td>192.168.51.118:443 Lan 192.168.208.146 Hyper-v&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>IIS Webserver&lt;/td>
&lt;td>Other web app (Webdav)&lt;/td>
&lt;td>Windows&lt;/td>
&lt;td>HTTP&lt;/td>
&lt;td>192.168.208.145:8088/S4f_/ Hyper-v&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Guacamole&lt;/td>
&lt;td>HTML5 RDP server&lt;/td>
&lt;td>Hyper-v (Docker)&lt;/td>
&lt;td>HTTP&lt;/td>
&lt;td>127.0.0.1:8080/rdp/ Hyper-v&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RDP&lt;/td>
&lt;td>Microsoft remote desktop&lt;/td>
&lt;td>Windows&lt;/td>
&lt;td>RDP&lt;/td>
&lt;td>192.168.208.145:3389 Hyper-v&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h1 id="no-need-to-prepare-config-file">No Need To Prepare Config File&lt;/h1>
&lt;p>More offcial Docs &lt;a href="guacamole.apache.org/doc/0.8.4/gug/configuring-guacamole.html#user-mapping">Here&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>This Part&lt;/strong> is for the native build therefore &lt;strong>SHOULD BE SKIPPED&lt;/strong>.&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/p>
&lt;/blockquote>
&lt;p>As we use docker file here, the default user has been set to &lt;code>guacadmin&lt;/code> with password &lt;code>guacadmin&lt;/code>.&lt;/p>
&lt;h1 id="open-firewall-for-iis-unusual-port">Open Firewall for IIS&amp;rsquo; Unusual Port&lt;/h1>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Windows&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>After binding port &lt;code>8088&lt;/code> to IIS server&amp;rsquo;s http service, there are addtional steps for unusual port other than &lt;code>80&lt;/code> and &lt;code>443&lt;/code>.
Open firewall advance settings, add allow rules for &lt;code>8080&lt;/code>. In &lt;code>Scope&lt;/code> Remote IP address part, add ip range &lt;code>192.168.208.0&lt;/code> to &lt;code>192.168.208.255&lt;/code>. In &lt;code>Advance&lt;/code> Profiles part, check all three checkboxs and confirm.&lt;/p>
&lt;h1 id="install-guacamole-by-docker">Install Guacamole by Docker&lt;/h1>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Hyper-v (Debian10)&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="//hub.docker.com/r/oznu/guacamole">Docker Site&lt;/a> and &lt;a href="//github.com/oznu/docker-guacamole">uploader&amp;rsquo;s Github&lt;/a>&lt;/p>
&lt;ol>
&lt;li>Pull image from docker&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">docker pull oznu/guacamole
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Build a &lt;code>Dockerfile&lt;/code> which is used for changing base url.
Run &lt;strong>&lt;code>docker build -t guapath .&lt;/code>&lt;/strong> at the place where you put the &lt;code>Dockerfile&lt;/code> to bulid a new image.&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> oznu/guacamole:latest&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> set -x &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> rm -rf &lt;span style="color:#e6db74">${&lt;/span>CATALINA_HOME&lt;span style="color:#e6db74">}&lt;/span>/webapps/ROOT &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> mv &lt;span style="color:#e6db74">${&lt;/span>CATALINA_HOME&lt;span style="color:#e6db74">}&lt;/span>/webapps/ROOT.war &lt;span style="color:#e6db74">${&lt;/span>CATALINA_HOME&lt;span style="color:#e6db74">}&lt;/span>/webapps/rdp.war&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>Run the container (replace &lt;code>/root/guacamole&lt;/code> with your config directory which should &lt;code>mkdir&lt;/code> first when new build) from your new-built image.&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">docker run -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> --name&lt;span style="color:#f92672">=&lt;/span>win10rdp &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -p 127.0.0.1:8080:8080 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> -v /root/guacamole:/config &lt;span style="color:#ae81ff">\
&lt;/span>&lt;span style="color:#ae81ff">&lt;/span> guapath
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="nginx-url-rewrite">Nginx URL Rewrite&lt;/h1>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Hyper-v (Debian10)&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://guacamole.apache.org/doc/gug/proxying-guacamole.html#nginx">Offcial Document&lt;/a>&lt;/p>
&lt;p>My original plan is to use &lt;code>IIS ARR3.0&lt;/code> module to achive the URL rewrite purpose as this IIS webserver also do the job of sharing my files in Lan via Webdav. But after a query online, I find out that the support of &lt;code>Websocket&lt;/code> in IIS which &lt;code>Guacamole&lt;/code> needed to communicate seems lack. Therefore I use &lt;code>Nginx&lt;/code> to do reverse proxy both for &lt;code>Guacamole&lt;/code> in &lt;code>Hyper-V&lt;/code> and Webdav that host on IIS.&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>&lt;/p>
&lt;h2 id="assign-ips-to-vm-3">Assign IPs to VM &lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>&lt;/h2>
&lt;p>To get double IPs in debian VM, first you need to add two network interfaces (here for example &lt;code>eth0&lt;/code> is external for Lan and the &lt;code>eth1&lt;/code> is internal to host) on hyper-v. Then login to the VM and add those lines to &lt;code>/etc/network/interfaces&lt;/code>, &lt;code>eth1&lt;/code>'s static ip is different from the host &lt;code>192.168.208.145&lt;/code> (like one number after) and mask is same as host&amp;rsquo;s (&lt;strong>you can find those in Windows Cmd &lt;code>ipconfig /all&lt;/code>&lt;/strong>). This internal ip is related to &lt;code>firewall&lt;/code> settings in Windows so you need to assign one manually to access the host Windows:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">auto eth0
iface eth0 inet dhcp
auto eth1
iface eth1 inet static
ip 192.168.208.146
mask 255.255.255.240
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Apply changes by &lt;code>systemctl restart networking&lt;/code>. Type &lt;code>ip a&lt;/code> in command to find your IPs.&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Windows&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>To add static IP in Windows, open Cmd(Administrator) and input:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-cmd" data-lang="cmd">netsh interface ip set address name=&lt;span style="color:#e6db74">&amp;#34;vEthernet (Default Switch)&amp;#34;&lt;/span> static 192.168.208.145 255.255.255.240 none
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Add this command to &lt;code>Manage&lt;/code>-&amp;gt;&lt;code>Scheduled Tasks&lt;/code>-&amp;gt;&lt;code>Create a Basic Task&lt;/code> and set it &lt;code>run as administrator&lt;/code> to get static ip rather than random one that Windows assign to on startup. Disable &lt;code>only start task when plug in power&lt;/code> and add a delay for &lt;code>30s&lt;/code> after startup.&lt;/p>
&lt;p>By default, Hyper-v will give VM a random Mac which would make your router assign new ip for your VM&amp;rsquo;s external network on boot. Open VM&amp;rsquo;s settings, expand your external &lt;code>Network Adapter&lt;/code> and click on &lt;code>Advanced Features&lt;/code>. In &lt;code>Mac Address&lt;/code> select &lt;code>static&lt;/code> and input a Mac address.&lt;/p>
&lt;h2 id="install-nginx-with-webdav-module">Install Nginx with Webdav module&lt;/h2>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Hyper-v (Debian10)&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">sudo apt-get install nginx-full -y
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="remove-default-page">Remove Default Page&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">rm /etc/nginx/sites-enabled/default
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="add-proxy-config">Add Proxy Config&lt;/h2>
&lt;p>Add those lines to your &lt;code>/etc/nginx/nginx.conf&lt;/code> file inside the &lt;code>server&lt;/code> section.
Replace &lt;code>rdp&lt;/code> with your &lt;code>guacamole&lt;/code>'s url path.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> location /rdp/ &lt;span style="color:#f92672">{&lt;/span>
proxy_redirect off;
proxy_buffering off;
proxy_http_version 1.1;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection $http_connection;
access_log off;
proxy_pass http://127.0.0.1:8080/rdp/;
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Replace &lt;code>S4f_&lt;/code> with your IIS Webdav url path, and &lt;code>192.168.208.145&lt;/code> with your Windows&amp;rsquo;s internal ip. I also changed the query string from client to IIS to fix problems (it&amp;rsquo;s an &lt;strong>Nginx bug&lt;/strong> when reverse proxy a webdav request, especially when use &lt;code>MOVE&lt;/code> method, the &lt;code>Destination&lt;/code> header would be set as nginx&amp;rsquo;s address rather than IIS&amp;rsquo; &lt;sup id="fnref:4">&lt;a href="#fn:4" class="footnote-ref" role="doc-noteref">4&lt;/a>&lt;/sup>) &lt;del>by &lt;code>if set&lt;/code>&lt;/del>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> &lt;span style="color:#75715e"># add in http&lt;/span>
map $http_destination $destination &lt;span style="color:#f92672">{&lt;/span>
~*&lt;span style="color:#f92672">(&lt;/span>https?:&lt;span style="color:#ae81ff">\/\/&lt;/span>&lt;span style="color:#f92672">)([&lt;/span>a-z0-9&lt;span style="color:#ae81ff">\.&lt;/span>&lt;span style="color:#f92672">]&lt;/span>+&lt;span style="color:#ae81ff">\/&lt;/span>&lt;span style="color:#f92672">)(&lt;/span>.+&lt;span style="color:#f92672">)&lt;/span>$ http://192.168.208.145:8088/$3;
default $http_destination;
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#75715e"># add in server&lt;/span>
location /S4f_/ &lt;span style="color:#f92672">{&lt;/span>
proxy_redirect off;
proxy_buffering off;
proxy_http_version 1.1;
proxy_set_header Destination $destination;
&lt;span style="color:#75715e"># don&amp;#39;t set this header as webdav destination check needed&lt;/span>
&lt;span style="color:#75715e"># proxy_set_header Host $http_host;&lt;/span>
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header http_x_forwarded_for $remote_addr;
proxy_set_header remote_addr $remote_addr;
access_log off;
proxy_pass http://192.168.208.145:8088/S4f_/;
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="config-https-and-auth">Config HTTPS and Auth&lt;/h2>
&lt;p>About how to generate self-signed certificate, you can refer to &lt;a href="../self-signed-ca-server-cert">Here&lt;/a>.
Copy your &lt;code>server.crt&lt;/code> and &lt;code>server.key&lt;/code> to &lt;code>nginx/&lt;/code> folder (use &lt;code>scp /path/to/file username@ip.ip.ip.ip:/path/to/destination&lt;/code> or &lt;code>Winscp&lt;/code>).
You can add extra auth for anyone who visit the site by nginx&amp;rsquo;s &lt;code>basic auth&lt;/code>&lt;sup id="fnref:5">&lt;a href="#fn:5" class="footnote-ref" role="doc-noteref">5&lt;/a>&lt;/sup>.
Replace &lt;code>server&lt;/code> config with following lines.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">server &lt;span style="color:#f92672">{&lt;/span>
listen &lt;span style="color:#ae81ff">443&lt;/span> ssl http2;
server_name localhost;
server_tokens off;
ssl_certificate server.crt;
ssl_certificate_key server.key;
ssl_protocols TLSv1.2 TLSv1.3;
ssl_prefer_server_ciphers on;
ssl_ciphers HIGH:!aNULL:!MD5;
add_header Strict-Transport-Security &lt;span style="color:#e6db74">&amp;#34;max-age=31536000; includeSubDomains&amp;#34;&lt;/span> always;
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And to disable default nginx index page, add in &lt;code>server&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> location / &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> 404;
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>&lt;strong>As a summary, your &lt;code>nginx.conf&lt;/code> file should look like this:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># Default settings and others&lt;/span>
http &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e"># Default but remember to delete SSL-related settings&lt;/span>
&lt;span style="color:#75715e"># Because it&amp;#39;s included in server&lt;/span>
map $http_destination $destination &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e"># ..&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
server &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e"># ...&lt;/span>
location / &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> 404;
&lt;span style="color:#f92672">}&lt;/span>
location /rdp/ &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e"># ...&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
location /S4f_/ &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e"># ...&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When done, restart your Nginx service:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">sudo systemctl restart nginx
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="manage-nginx-and-guacamole-to-autostart">Manage Nginx and Guacamole to Autostart&lt;/h2>
&lt;p>For &lt;code>Nginx&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># nginx autostart (enable)/ disable (disable)&lt;/span>
sudo systemctl enable nginx
&lt;span style="color:#75715e"># nginx start/stop/status&lt;/span>
sudo systemctl start nginx
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To check port use &lt;code>lsof -i -P&lt;/code>.The Nginx log is in &lt;code>/var/log/nginx/&lt;/code> as &lt;code>access.log&lt;/code> and &lt;code>error.log&lt;/code> for debug.&lt;/p>
&lt;hr>
&lt;p>For &lt;code>Guacamole&lt;/code>, in &lt;code>/etc/systemd/system/docker-win10rdp.service&lt;/code> add:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-toml" data-lang="toml">[&lt;span style="color:#a6e22e">Unit&lt;/span>]
&lt;span style="color:#a6e22e">Description&lt;/span>=&lt;span style="color:#a6e22e">Docker&lt;/span> &lt;span style="color:#a6e22e">for&lt;/span> &lt;span style="color:#a6e22e">win10rdp&lt;/span>
&lt;span style="color:#a6e22e">Requires&lt;/span>=&lt;span style="color:#a6e22e">docker&lt;/span>.&lt;span style="color:#a6e22e">service&lt;/span>
&lt;span style="color:#a6e22e">After&lt;/span>=&lt;span style="color:#a6e22e">docker&lt;/span>.&lt;span style="color:#a6e22e">service&lt;/span>
[&lt;span style="color:#a6e22e">Service&lt;/span>]
&lt;span style="color:#a6e22e">Restart&lt;/span>=&lt;span style="color:#a6e22e">always&lt;/span>
&lt;span style="color:#a6e22e">ExecStart&lt;/span>=&lt;span style="color:#960050;background-color:#1e0010">/&lt;/span>&lt;span style="color:#a6e22e">usr&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/&lt;/span>&lt;span style="color:#a6e22e">bin&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/&lt;/span>&lt;span style="color:#a6e22e">docker&lt;/span> &lt;span style="color:#a6e22e">start&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">-&lt;/span>&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#a6e22e">win10rdp&lt;/span>
&lt;span style="color:#a6e22e">ExecStop&lt;/span>=&lt;span style="color:#960050;background-color:#1e0010">/&lt;/span>&lt;span style="color:#a6e22e">usr&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/&lt;/span>&lt;span style="color:#a6e22e">bin&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/&lt;/span>&lt;span style="color:#a6e22e">docker&lt;/span> &lt;span style="color:#a6e22e">stop&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">-&lt;/span>&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#a6e22e">win10rdp&lt;/span>
[&lt;span style="color:#a6e22e">Install&lt;/span>]
&lt;span style="color:#a6e22e">WantedBy&lt;/span>=&lt;span style="color:#a6e22e">default&lt;/span>.&lt;span style="color:#a6e22e">target&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Enable the service:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">sudo systemctl enable docker-win10rdp.service
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="edit-guacamole-settings">Edit Guacamole Settings&lt;/h1>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Browser&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;h2 id="add-account">Add Account&lt;/h2>
&lt;p>Access &lt;code>Guacamole&lt;/code>'s web page using your VM&amp;rsquo;s external ip address &lt;code>https://192.168.51.118/rdp&lt;/code> with &lt;code>guacadmin&lt;/code> for both username and password.&lt;br>
After a successfully login, open settings and click on the &lt;code>Users&lt;/code>. Create your own account with all permissions checked. Sign in your own account and delete the default &lt;code>guacadmin&lt;/code> one.&lt;/p>
&lt;h2 id="add-connections">Add Connections&lt;/h2>
&lt;p>Click on the &lt;code>New Connection&lt;/code> inside the &lt;code>Connections&lt;/code>. Fill the Name, Protocol, Hostname (Hyper-v internal ip), Port, Username, Password, Security Mode and check the &lt;code>Ignore server certificate&lt;/code>. Save the changes.&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Hyper-v (Debian10)&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>If you want to enhance VM server&amp;rsquo;s security, you can add a &lt;code>ssh&lt;/code> connection from docker to host. Use &lt;code>ip a&lt;/code> to check &lt;code>docker0&lt;/code> host&amp;rsquo;s ip. Also, change the settings in &lt;code>/etc/ssh/sshd_config&lt;/code> by change &lt;code>port&lt;/code> and &lt;code>listenAddress&lt;/code>. Apply changes &lt;code>sudo systemctl restart sshd&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">Port &lt;span style="color:#ae81ff">25678&lt;/span>
&lt;span style="color:#75715e"># same as docker0 in ip a&lt;/span>
ListenAddress 172.18.0.1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Also add these command after &lt;code>sudo systemctl edit sshd&lt;/code> to allow &lt;code>sshd&lt;/code> start when &lt;code>docker0&lt;/code>'s ready:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#f92672">[&lt;/span>Service&lt;span style="color:#f92672">]&lt;/span>
Restart&lt;span style="color:#f92672">=&lt;/span>on-failure
RestartSec&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>
RestartPreventExitStatus&lt;span style="color:#f92672">=&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="test-on-connection">Test on Connection&lt;/h2>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Browser&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>Back to &lt;code>Home&lt;/code>, click on the connection you just added. Check if everything is fine.&lt;/p>
&lt;h2 id="expose-3389-to-hyper-v-only">Expose 3389 to Hyper-v only&lt;/h2>
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>In Windows&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>Open firewall advance settings, add two allow rules for TCP and UDP port&lt;code>3389&lt;/code>. In &lt;code>Scope&lt;/code> Remote IP address part, add ip range &lt;code>192.168.208.0&lt;/code> to &lt;code>192.168.208.255&lt;/code>. In &lt;code>Advance&lt;/code> Profiles part, check all three checkboxs and confirm. Disable old TCP and UDP port &lt;code>3389&lt;/code> allow rules.&lt;/p>
&lt;h1 id="appendices">Appendices&lt;/h1>
&lt;section class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1" role="doc-endnote">
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>Deprecated:&lt;/strong>&lt;/em> change config of Guacamole now in its GUI control panel rather in its config file.&lt;/p>
&lt;/blockquote>
&lt;p>First, prepare the config file that will be used by &lt;code>guacamole&lt;/code>.&lt;br>
Replace &lt;code>192.168.208.145&lt;/code> with your &lt;code>Windows&lt;/code> IP address or &lt;code>Hostname&lt;/code> (&lt;strong>not recommend&lt;/strong>) connected to the &lt;code>Hyper-v&lt;/code> (as &lt;code>192.168.208.146&lt;/code> is the VM&amp;rsquo;s IP that &lt;code>Hyper-v&lt;/code> assigned to). Also don&amp;rsquo;t forget to change the &lt;code>username&lt;/code> and &lt;code>password (md5)&lt;/code>.&lt;br>
In &lt;code>Debian&lt;/code>, you can use &lt;code>md5sum &amp;lt;File contains PASSWORD&amp;gt;&lt;/code> to hash your plain password.&lt;br>
&lt;strong>/root/guacamole/user-mapping.xml&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-xml" data-lang="xml">&lt;span style="color:#f92672">&amp;lt;user-mapping&amp;gt;&lt;/span>
&lt;span style="color:#75715e">&amp;lt;!-- Per-user authentication and config information
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;authorize username=&amp;#34;USERNAME&amp;#34; password=&amp;#34;PASSWORD&amp;#34;&amp;gt;
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;protocol&amp;gt;vnc&amp;lt;/protocol&amp;gt;
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;param name=&amp;#34;hostname&amp;#34;&amp;gt;localhost&amp;lt;/param&amp;gt;
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;param name=&amp;#34;port&amp;#34;&amp;gt;5900&amp;lt;/param&amp;gt;
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;param name=&amp;#34;password&amp;#34;&amp;gt;VNCPASS&amp;lt;/param&amp;gt;
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;/authorize&amp;gt;
&lt;/span>&lt;span style="color:#75715e"> --&amp;gt;&lt;/span>
&lt;span style="color:#75715e">&amp;lt;!-- Another user, but using md5 to hash the password
&lt;/span>&lt;span style="color:#75715e"> (example below uses the md5 hash of &amp;#34;PASSWORD&amp;#34;) --&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;authorize&lt;/span>
&lt;span style="color:#a6e22e">username=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;admin&amp;#34;&lt;/span>
&lt;span style="color:#a6e22e">password=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;**PASSWORD CONVERT TO MD5**&amp;#34;&lt;/span>
&lt;span style="color:#a6e22e">encoding=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;md5&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;connection&lt;/span> &lt;span style="color:#a6e22e">name=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Unique Name&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;protocol&amp;gt;&lt;/span>rdp&lt;span style="color:#f92672">&amp;lt;/protocol&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;param&lt;/span> &lt;span style="color:#a6e22e">name=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;hostname&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>192.168.208.145&lt;span style="color:#f92672">&amp;lt;/param&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;param&lt;/span> &lt;span style="color:#a6e22e">name=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;port&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>3389&lt;span style="color:#f92672">&amp;lt;/param&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;/connection&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;/authorize&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;/user-mapping&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div> &lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/li>
&lt;li id="fn:2" role="doc-endnote">
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>Deprecated:&lt;/strong>&lt;/em> use nginx reverse proxy instead because arr&amp;rsquo;s lack of Websocket support.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>Install Application Request Routing (ARR) Module&lt;/strong>&lt;br>
Install &lt;code>ARR 3.0&lt;/code> for &lt;code>Reverse Proxy&lt;/code> support. You can install the ARR module directly from the location: &lt;a href="http://www.microsoft.com/web/gallery/install.aspx?appid=ARRv3_0">http://www.microsoft.com/web/gallery/install.aspx?appid=ARRv3_0&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Change URL Rewrite Settings&lt;/strong>&lt;br>
Open the &lt;code>IIS Manager&lt;/code> and open the &lt;code>Default Web Site&lt;/code> config pannel. Then double click on the &lt;code>URL Rewrite&lt;/code> option.&lt;br>
Add 2 rules for &lt;code>Inbound rules&lt;/code> and another one for &lt;code>Outbound Rules&lt;/code> by clicking on the &lt;code>Add Rule(s)...&lt;/code> action and Choose the &lt;code>Blank Rule&lt;/code> template. Contents that needed to be changed are in the following tables:&lt;/p>
&lt;p>&lt;strong>Inbound Rules&lt;/strong>&lt;br>
The first line of the table prevent address &lt;code>/S4f_/&lt;/code> (another web app that hosted on the IIS server) to be rewritten to the &lt;code>rdp&lt;/code> sevice. Also need to check the &lt;strong>Append query string&lt;/strong> checkbox.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Input&lt;/th>
&lt;th>Match&lt;/th>
&lt;th>Pattern&lt;/th>
&lt;th>Action Type&lt;/th>
&lt;th>Action URL&lt;/th>
&lt;th>Stop Processing&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>S4f&lt;/td>
&lt;td>-&lt;/td>
&lt;td>match&lt;/td>
&lt;td>S4f_(/?)(.*)&lt;/td>
&lt;td>Rewrite&lt;/td>
&lt;td>{R:0}&lt;/td>
&lt;td>True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>rdp&lt;/td>
&lt;td>-&lt;/td>
&lt;td>match&lt;/td>
&lt;td>rdp(/?)(.*)&lt;/td>
&lt;td>Rewrite&lt;/td>
&lt;td>http://172.17.111.38:8080/{R:0}&lt;/td>
&lt;td>True&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/li>
&lt;li id="fn:3" role="doc-endnote">
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>Deprecated:&lt;/strong>&lt;/em> the hostname that Hyper-v provided is not stable. It&amp;rsquo;s better set static ip both manually.&lt;/p>
&lt;/blockquote>
&lt;p>The old host-accessed-by-hostname (&lt;code>HOSTNAME.mshome.net&lt;/code>) plan is rather more unastable than assigning static ip to both host &lt;code>192.168.208.145&lt;/code> and VM &lt;code>192.168.208.146&lt;/code>. &lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:4" role="doc-endnote">
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>Important:&lt;/strong>&lt;/em> there is a &lt;strong>bug&lt;/strong> when Nginx handle reverse proxy to a webdav server. Related: &lt;a href="https://serverfault.com/questions/121766/webdav-rename-fails-on-an-apache-mod-dav-install-behind-nginx">discussion&lt;/a> and &lt;a href="https://github.com/keeweb/keeweb/issues/1326">webdav path requirement&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;p>In Nginx&amp;rsquo;s reverse proxy part &lt;code>S4f_&lt;/code>, I add extra filter to change query uri for Webdav service. I&amp;rsquo;m using &lt;code>rclone&lt;/code> as my Webdav client~~, however, it contains bugs while sending requests to a proxyed server~~.
For example, rclone sends method &lt;code>MOVE&lt;/code> and query uri &lt;code>https://&amp;lt;nginx&amp;gt;/S4f_/path/to/file&lt;/code> to the server when rename a file while the correct query uri without proxy is &lt;code>http://&amp;lt;IIS&amp;gt;/S4f_/path/to/file&lt;/code>. ~~Therefore, to fix the problem, I add extra if-statement and regex &lt;code>set&lt;/code> to convert path that contains scheme and server name to relative path.~~&lt;br>
**Edit1:** It seems that it&amp;rsquo;s a common problem when use Nginx as reverse proxy and not just the bug of rclone. More information about this is in description above. The Webdav server will check the &lt;code>Destination&lt;/code> header in query uri if it match the internal server.&lt;br>
**Edit2:** Because of &lt;a href="https://tools.ietf.org/html/rfc2518#section-9.3">RFC2518&lt;/a>, &lt;code>Destination&lt;/code> header should be absolute URI. Convert it to relative is not the solution. The better way is to rewrite the scheme and path to match the internal communication when proxy to IIS backend.&lt;br>
**Edit3:** &lt;code>if-state&lt;/code> in Nginx will double escape() the query string (like convert already converted string &lt;code>%6E&lt;/code> to &lt;code>%256E&lt;/code>). So I use &lt;code>map&lt;/code> (**should place in &lt;code>http&lt;/code> section**) instead. For some reason, &lt;code>IIS Webdav&lt;/code> server behind proxy will check if &lt;code>MOVE&lt;/code> method&amp;rsquo;s query string &lt;code>Destination&lt;/code> is match the proxyed &lt;code>Host&lt;/code>. To avoid error, delete or comment the &lt;code>proxy_set_header host $http_host&lt;/code> in &lt;code>location /S4f_/ {..}&lt;/code>. &lt;a href="#fnref:4" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:5" role="doc-endnote">
&lt;blockquote>
&lt;p>&lt;em>&lt;strong>Optional:&lt;/strong>&lt;/em> set basic auth for Nginx.&lt;/p>
&lt;/blockquote>
&lt;p>Generate your &lt;code>conf/userpass.txt&lt;/code> file by command &lt;code>htpasswd&lt;/code> or online &lt;code>MD5 htpasswd&lt;/code> generator. Text inside are like &lt;code>share:$apr1$AOW5qtOx$7D3rsVK/jIQuQYqd11/Xg0&lt;/code>.
Add those lines in your &lt;code>nginx.conf&lt;/code> &lt;code>server&lt;/code> section.&lt;/p>
&lt;pre>&lt;code> auth_basic &amp;quot;Auth&amp;quot;;
auth_basic_user_file userpass.txt;
&lt;/code>&lt;/pre> &lt;a href="#fnref:5" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/li>
&lt;/ol>
&lt;/section>
- //wmillers.github.io/posts/docker-guacamole-rdp/ - wmillers</description></item><item><title>如何实现 Github 免密码 git push 内容</title><link>//wmillers.github.io/document/github-ssh-git-push/</link><pubDate>Wed, 01 Jul 2020 05:38:20 +0800</pubDate><guid>//wmillers.github.io/document/github-ssh-git-push/</guid><description>源 //wmillers.github.io/document/github-ssh-git-push/ -&lt;blockquote>
&lt;p>content from &lt;a href="https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Github Help&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="generating-a-new-ssh-key">Generating a new SSH key&lt;/h1>
&lt;ol>
&lt;li>Open Git Bash.&lt;/li>
&lt;li>Paste the text below, substituting in your GitHub email address.&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ ssh-keygen -t rsa -b &lt;span style="color:#ae81ff">4096&lt;/span> -C &lt;span style="color:#e6db74">&amp;#34;your_email@example.com&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This creates a new ssh key, using the provided email as a label.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&amp;gt; Generating public/private rsa key pair.
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>When you&amp;rsquo;re prompted to &amp;ldquo;Enter a file in which to save the key,&amp;rdquo; press Enter. This accepts the default file location.&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&amp;gt; Enter a file in which to save the key &lt;span style="color:#f92672">(&lt;/span>/c/Users/you/.ssh/id_rsa&lt;span style="color:#f92672">)&lt;/span>:&lt;span style="color:#f92672">[&lt;/span>Press enter&lt;span style="color:#f92672">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>At the prompt, type a secure passphrase. For more information, see &amp;ldquo;Working with SSH key passphrases&amp;rdquo;.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&amp;gt; Enter passphrase &lt;span style="color:#f92672">(&lt;/span>empty &lt;span style="color:#66d9ef">for&lt;/span> no passphrase&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>Type a passphrase&lt;span style="color:#f92672">]&lt;/span>
&amp;gt; Enter same passphrase again: &lt;span style="color:#f92672">[&lt;/span>Type passphrase again&lt;span style="color:#f92672">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="adding-your-ssh-key-to-the-ssh-agent">Adding your SSH key to the ssh-agent&lt;/h1>
&lt;p>Before adding a new SSH key to the ssh-agent to manage your keys, you should have checked for existing SSH keys and generated a new SSH key.&lt;/p>
&lt;p>If you have GitHub Desktop installed, you can use it to clone repositories and not deal with SSH keys. It also comes with the Git Bash tool, which is the preferred way of running git commands on Windows.&lt;/p>
&lt;ol>
&lt;li>Ensure the ssh-agent is running:&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>If you are using the Git Shell that&amp;rsquo;s installed with GitHub Desktop, the ssh-agent should be running.&lt;/li>
&lt;li>If you are using another terminal prompt, such as Git for Windows, you can use the &amp;ldquo;Auto-launching the ssh-agent&amp;rdquo; instructions in &amp;ldquo;Working with SSH key passphrases&amp;rdquo;, or start it manually:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># start the ssh-agent in the background&lt;/span>
$ eval &lt;span style="color:#66d9ef">$(&lt;/span>ssh-agent -s&lt;span style="color:#66d9ef">)&lt;/span>
&amp;gt; Agent pid &lt;span style="color:#ae81ff">59566&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Add your SSH private key to the ssh-agent. If you created your key with a different name, or if you are adding an existing key that has a different name, replace id_rsa in the command with the name of your private key file.&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ ssh-add ~/.ssh/id_rsa
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="add-the-ssh-key-to-your-github-account">Add the SSH key to your GitHub account&lt;/h1>
&lt;ol>
&lt;li>Copy the SSH key to your clipboard.&lt;/li>
&lt;/ol>
&lt;p>If your SSH key file has a different name than the example code, modify the filename to match your current setup. When copying your key, don&amp;rsquo;t add any newlines or whitespace.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ clip &amp;lt; ~/.ssh/id_rsa.pub
&lt;span style="color:#75715e"># Copies the contents of the id_rsa.pub file to your clipboard&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>&lt;strong>Tip&lt;/strong>: If clip isn&amp;rsquo;t working, you can locate the hidden .ssh folder, open the file in your favorite text editor, and copy it to your clipboard.&lt;/p>
&lt;/blockquote>
&lt;ol start="2">
&lt;li>
&lt;p>In the upper-right corner of any page, click your profile photo, then click &lt;strong>Settings&lt;/strong>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>In the user settings sidebar, click &lt;strong>SSH and GPG keys&lt;/strong>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click &lt;strong>New SSH key&lt;/strong> or &lt;strong>Add SSH key&lt;/strong>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>In the &amp;ldquo;Title&amp;rdquo; field, add a descriptive label for the new key. For example, if you&amp;rsquo;re using a personal Mac, you might call this key &amp;ldquo;Personal MacBook Air&amp;rdquo;.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Paste your key into the &amp;ldquo;Key&amp;rdquo; field.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Click &lt;strong>Add SSH key&lt;/strong>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If prompted, confirm your GitHub password.&lt;/p>
&lt;/li>
&lt;/ol>
- //wmillers.github.io/document/github-ssh-git-push/ - wmillers</description></item><item><title>Markdown 语法速成</title><link>//wmillers.github.io/document/markdown-cheatsheet/</link><pubDate>Wed, 01 Jul 2020 04:50:05 +0800</pubDate><guid>//wmillers.github.io/document/markdown-cheatsheet/</guid><description>源 //wmillers.github.io/document/markdown-cheatsheet/ -&lt;blockquote>
&lt;p>This document is originated from &lt;a href="https://www.markdownguide.org/cheat-sheet/">markdownguide&lt;/a>, converted from html to markdown by &lt;a href="https://products.aspose.app/html/conversion/html-to-md">aspose&lt;/a>, and fix format by myself.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://www.markdownguide.org/getting-started/">Get Started&lt;/a>&lt;br>
&lt;a href="https://www.markdownguide.org/cheat-sheet/">Cheat Sheet&lt;/a>&lt;br>
&lt;a href="https://www.markdownguide.org//www.markdownguide.org/basic-syntax/">Basic Syntax&lt;/a>&lt;br>
&lt;a href="https://www.markdownguide.org//www.markdownguide.org/extended-syntax/">Extended Syntax&lt;/a>&lt;br>
&lt;a href="https://www.markdownguide.org/tools/">Tools&lt;/a>&lt;br>
&lt;a href="https://www.markdownguide.org/book/">Book&lt;/a>&lt;/p>
&lt;h1 id="markdown-cheat-sheet">Markdown Cheat Sheet&lt;/h1>
&lt;p>A quick reference to the Markdown syntax.&lt;/p>
&lt;h2 id="overview">Overview&lt;/h2>
&lt;p>This Markdown cheat sheet provides a quick overview of all the Markdown syntax elements. It can’t cover every edge case, so if you need more information about any of these elements, refer to our reference guides for &lt;a href="//www.markdownguide.org/basic-syntax">basic syntax&lt;/a> and &lt;a href="//www.markdownguide.org/extended-syntax">extended syntax&lt;/a>.&lt;/p>
&lt;h2 id="basic-syntax">Basic Syntax&lt;/h2>
&lt;p>These are the elements outlined in John Gruber’s original design document. All Markdown applications support these elements.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Element&lt;/th>
&lt;th>Markdown Syntax&lt;/th>
&lt;th>Render&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#headings">Heading&lt;/a>&lt;/td>
&lt;td># H1&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>## H2&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>### H3&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#bold">Bold&lt;/a>&lt;/td>
&lt;td>&lt;code>**bold text**&lt;/code>&lt;/td>
&lt;td>&lt;strong>bold text&lt;/strong>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#italic">Italic&lt;/a>&lt;/td>
&lt;td>&lt;code>*italicized text*&lt;/code>&lt;/td>
&lt;td>&lt;em>italicized text&lt;/em>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#blockquotes-1">Blockquote&lt;/a>&lt;/td>
&lt;td>&amp;gt; blockquote&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#ordered-lists">Ordered List&lt;/a>&lt;/td>
&lt;td>1. First item&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>1. Second item&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>1. Third item&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#unordered-lists">Unordered List&lt;/a>&lt;/td>
&lt;td>- First item&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>- Second item&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>- Third item&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#code">Code&lt;/a>&lt;/td>
&lt;td>` code `&lt;/td>
&lt;td>&lt;code>code&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#horizontal-rules">Horizontal Rule&lt;/a>&lt;/td>
&lt;td>&lt;code>---&lt;/code>&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#links">Link&lt;/a>&lt;/td>
&lt;td>&lt;code>[title](https://www.example.com)&lt;/code>&lt;/td>
&lt;td>&lt;a href="https://www.example.com">title&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/basic-syntax/#images-1">Image&lt;/a>&lt;/td>
&lt;td>&lt;code>![alt text](image.jpg)&lt;/code>&lt;/td>
&lt;td>&lt;img src="image.jpg" alt="alt text">&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="extended-syntax">Extended Syntax&lt;/h2>
&lt;p>These elements extend the basic syntax by adding additional features. Not all Markdown applications support these elements.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Element&lt;/th>
&lt;th>Markdown Syntax&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#tables">Table&lt;/a>&lt;/td>
&lt;td>| Syntax | Description |&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>| &amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash; | &amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash; |&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>| Header | Title |&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>| Paragraph | Text |&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#fenced-code-blocks">Fenced Code Block&lt;/a>&lt;/td>
&lt;td>` ` `&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>{&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>  &amp;ldquo;firstName&amp;rdquo;: &amp;ldquo;John&amp;rdquo;,&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>  &amp;ldquo;lastName&amp;rdquo;: &amp;ldquo;Smith&amp;rdquo;,&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>  &amp;ldquo;age&amp;rdquo;: 25&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>}&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>` ` `&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#footnotes">Footnote&lt;/a>&lt;/td>
&lt;td>Here&amp;rsquo;s a sentence with a footnote. [^1]&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>[^1]: This is the footnote.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#heading-ids">Heading ID&lt;/a>&lt;/td>
&lt;td>### My Great Heading {#custom-id}&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#definition-lists">Definition List&lt;/a>&lt;/td>
&lt;td>term&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>: definition&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#strikethrough">Strikethrough&lt;/a>&lt;/td>
&lt;td>&lt;code> ~~The world is flat.~~&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;a href="//www.markdownguide.org/extended-syntax/#task-lists">Task List&lt;/a>&lt;/td>
&lt;td>- [x] Write the press release&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>- [ ] Update the website&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>- [ ] Contact the media&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
- //wmillers.github.io/document/markdown-cheatsheet/ - wmillers</description></item><item><title>Hugo 文章前置标签语法</title><link>//wmillers.github.io/document/front-matter-of-hugo/</link><pubDate>Tue, 30 Jun 2020 20:22:24 +0800</pubDate><guid>//wmillers.github.io/document/front-matter-of-hugo/</guid><description>源 //wmillers.github.io/document/front-matter-of-hugo/ -&lt;blockquote>
&lt;p>An copy of &lt;a href="https://gohugo.io/content-management/front-matter/">Hugo Front Matter Document&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Hugo supports four formats for front matter, each with their own identifying tokens.&lt;/p>
&lt;h3 id="toml">TOML&lt;/h3>
&lt;p>identified by opening and closing +++.&lt;/p>
&lt;h3 id="yaml">YAML&lt;/h3>
&lt;p>identified by opening and closing &amp;mdash;.&lt;/p>
&lt;h3 id="json">JSON&lt;/h3>
&lt;p>a single JSON object surrounded by ‘{’ and ‘}’, followed by a new line.&lt;/p>
&lt;h3 id="org">ORG&lt;/h3>
&lt;p>a group of Org mode keywords in the format ‘#+KEY: VALUE’. Any line that does not start with #+ ends the front matter section. Keyword values can be either strings (#+KEY: VALUE) or a whitespace separated list of strings (#+KEY[]: VALUE_1 VALUE_2).&lt;/p>
&lt;p>&lt;em>In Hugo I just use YAML as my markdown files&amp;rsquo; front matter&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#66d9ef">categories&lt;/span>:
- Development
- VIM
&lt;span style="color:#66d9ef">date&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2012-04-06&amp;#34;&lt;/span>
&lt;span style="color:#66d9ef">description&lt;/span>: spf13-vim is a cross platform distribution of vim plugins and resources
for Vim.
&lt;span style="color:#66d9ef">slug&lt;/span>: spf13-vim&lt;span style="color:#ae81ff">-3-0&lt;/span>-release-and-new-website
&lt;span style="color:#66d9ef">tags&lt;/span>:
- .vimrc
- plugins
- spf13-vim
- vim
&lt;span style="color:#66d9ef">title&lt;/span>: spf13-vim &lt;span style="color:#ae81ff">3.0&lt;/span> release and new website
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="front-matter-variableshttpsgohugoiocontent-managementfront-matterfront-matter-variables">&lt;a href="https://gohugo.io/content-management/front-matter/#front-matter-variables">Front Matter Variables&lt;/a>&lt;/h1>
&lt;h2 id="predefined">&lt;strong>Predefined&lt;/strong>&lt;/h2>
&lt;p>There are a few predefined variables that Hugo is aware of. See &lt;a href="https://gohugo.io/variables/page/">Page Variables&lt;/a> for how to call many of these predefined variables in your templates.&lt;/p>
&lt;h3 id="aliases">aliases&lt;/h3>
&lt;p>an array of one or more aliases (e.g., old published paths of renamed content) that will be created in the output directory structure . See &lt;a href="https://gohugo.io/content-management/urls/#aliases">Aliases&lt;/a> for details.&lt;/p>
&lt;h3 id="audio">audio&lt;/h3>
&lt;p>an array of paths to audio files related to the page; used by the &lt;code>opengraph&lt;/code> &lt;a href="https://gohugo.io/templates/internal">internal template&lt;/a> to populate &lt;code>og:audio&lt;/code>.&lt;/p>
&lt;h3 id="cascade">cascade&lt;/h3>
&lt;p>a map of Front Matter keys whose values are passed down to the page’s descendents unless overwritten by self or a closer ancestor’s cascade. See &lt;a href="#front-matter-cascadehttpsgohugoiocontent-managementfront-matterfront-matter-cascade">Front Matter Cascade&lt;/a> for details.&lt;/p>
&lt;h3 id="date">date&lt;/h3>
&lt;p>the datetime assigned to this page. This is usually fetched from the date field in front matter, but this behaviour is configurable.&lt;/p>
&lt;h3 id="description">description&lt;/h3>
&lt;p>the description for the content.&lt;/p>
&lt;h3 id="draft">draft&lt;/h3>
&lt;p>if true, the content will not be rendered unless the &lt;code>--buildDrafts&lt;/code> flag is passed to the hugo command.&lt;/p>
&lt;h3 id="expirydate">expiryDate&lt;/h3>
&lt;p>the datetime at which the content should no longer be published by Hugo; expired content will not be rendered unless the &lt;code>--buildExpired&lt;/code> flag is passed to the hugo command.&lt;/p>
&lt;h3 id="headless">headless&lt;/h3>
&lt;p>if true, sets a leaf bundle to be &lt;a href="https://gohugo.io/content-management/page-bundles/#headless-bundle">headless&lt;/a>.&lt;/p>
&lt;h3 id="images">images&lt;/h3>
&lt;p>an array of paths to images related to the page; used by &lt;a href="https://gohugo.io/templates/internal">internal templates&lt;/a> such as &lt;code>_internal/twitter_cards.html&lt;/code>.&lt;/p>
&lt;h3 id="iscjklanguage">isCJKLanguage&lt;/h3>
&lt;p>if true, Hugo will explicitly treat the content as a CJK language; both &lt;code>.Summary&lt;/code> and &lt;code>.WordCount&lt;/code> work properly in CJK languages.&lt;/p>
&lt;h3 id="keywords">keywords&lt;/h3>
&lt;p>the meta keywords for the content.&lt;/p>
&lt;h3 id="layout">layout&lt;/h3>
&lt;p>the layout Hugo should select from the &lt;a href="https://gohugo.io/templates/lookup-order/">lookup order&lt;/a> when rendering the content. If a &lt;code>type&lt;/code> is not specified in the front matter, Hugo will look for the layout of the same name in the layout directory that corresponds with a content’s section. See &lt;a href="https://gohugo.io/content-management/types/#defining-a-content-type">“Defining a Content Type”&lt;/a>&lt;/p>
&lt;h3 id="lastmod">lastmod&lt;/h3>
&lt;p>the datetime at which the content was last modified.&lt;/p>
&lt;h3 id="linktitle">linkTitle&lt;/h3>
&lt;p>used for creating links to content; if set, Hugo defaults to using the &lt;code>linktitle&lt;/code> before the &lt;code>title&lt;/code>. Hugo can also &lt;a href="https://gohugo.io/templates/lists/#by-link-title">order lists of content by &lt;code>linktitle&lt;/code>&lt;/a>.&lt;/p>
&lt;h3 id="markup">markup&lt;/h3>
&lt;p>experimental; specify &lt;code>&amp;quot;rst&amp;quot;&lt;/code> for reStructuredText (requires &lt;code>rst2html&lt;/code>) or &lt;code>&amp;quot;md&amp;quot;&lt;/code> (default) for Markdown.&lt;/p>
&lt;h3 id="outputs">outputs&lt;/h3>
&lt;p>allows you to specify output formats specific to the content. See &lt;a href="https://gohugo.io/templates/output-formats/">output formats&lt;/a>.&lt;/p>
&lt;h3 id="publishdate">publishDate&lt;/h3>
&lt;p>if in the future, content will not be rendered unless the &lt;code>--buildFuture&lt;/code> flag is passed to &lt;code>hugo&lt;/code>.&lt;/p>
&lt;h3 id="resources">resources&lt;/h3>
&lt;p>used for configuring page bundle resources. See &lt;a href="https://gohugo.io/content-management/page-resources/">Page Resources&lt;/a>.&lt;/p>
&lt;h3 id="series">series&lt;/h3>
&lt;p>an array of series this page belongs to, as a subset of the &lt;code>series&lt;/code> &lt;a href="https://gohugo.io/content-management/taxonomies/">taxonomy&lt;/a>; used by the &lt;code>opengraph&lt;/code> &lt;a href="https://gohugo.io/templates/internal">internal template&lt;/a> to populate &lt;code>og:see_also&lt;/code>.&lt;/p>
&lt;h3 id="slug">slug&lt;/h3>
&lt;p>appears as the tail of the output URL. A value specified in front matter will override the segment of the URL based on the filename.&lt;/p>
&lt;h3 id="summary">summary&lt;/h3>
&lt;p>text used when providing a summary of the article in the &lt;code>.Summary&lt;/code> page variable; details available in the &lt;a href="https://gohugo.io/content-management/summaries/">content-summaries&lt;/a> section.&lt;/p>
&lt;h3 id="title">title&lt;/h3>
&lt;p>the title for the content.&lt;/p>
&lt;h3 id="type">type&lt;/h3>
&lt;p>the type of the content; this value will be automatically derived from the directory (i.e., the &lt;a href="https://gohugo.io/content-management/sections/">section&lt;/a>) if not specified in front matter.&lt;/p>
&lt;h3 id="url">url&lt;/h3>
&lt;p>the full path to the content from the web root. It makes no assumptions about the path of the content file. It also ignores any language prefixes of the multilingual feature.&lt;/p>
&lt;h3 id="videos">videos&lt;/h3>
&lt;p>an array of paths to videos related to the page; used by the &lt;code>opengraph&lt;/code> &lt;a href="https://gohugo.io/templates/internal">internal template&lt;/a> to populate &lt;code>og:video&lt;/code>.&lt;/p>
&lt;h3 id="weight">weight&lt;/h3>
&lt;p>used for &lt;a href="https://gohugo.io/templates/lists/">ordering your content in lists&lt;/a>. Lower weight gets higher precedence. So content with lower weight will come first. If set, weights should be non-zero, as 0 is interpreted as an unset weight.&lt;/p>
&lt;h3 id="taxonomies">&amp;lt;taxonomies&amp;gt;&lt;/h3>
&lt;p>field name of the plural form of the index. See &lt;code>tags&lt;/code> and &lt;code>categories&lt;/code> in the above front matter examples. Note that the plural form of user-defined taxonomies cannot be the same as any of the predefined front matter variables.&lt;/p>
&lt;blockquote>
&lt;p>If neither &lt;code>slug&lt;/code> nor &lt;code>url&lt;/code> is present and &lt;a href="https://gohugo.io/content-management/urls/#permalinks">permalinks are not configured otherwise in your site config file&lt;/a>, Hugo will use the filename of your content to create the output URL. See &lt;a href="https://gohugo.io/content-management/organization">Content Organization&lt;/a> for an explanation of paths in Hugo and &lt;a href="https://gohugo.io/content-management/urls/">URL Management&lt;/a> for ways to customize Hugo’s default behaviors.&lt;/p>
&lt;/blockquote>
&lt;h2 id="user-defined">&lt;strong>User-Defined&lt;/strong>&lt;/h2>
&lt;p>You can add fields to your front matter arbitrarily to meet your needs. These user-defined key-values are placed into a single &lt;code>.Params&lt;/code> variable for use in your templates.&lt;/p>
&lt;p>The following fields can be accessed via &lt;code>.Params.include_toc&lt;/code> and &lt;code>.Params.show_comments&lt;/code>, respectively. The &lt;a href="https://gohugo.io/variables/">Variables&lt;/a> section provides more information on using Hugo’s page- and site-level variables in your templates.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#66d9ef">include_toc&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;span style="color:#66d9ef">show_comments&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="front-matter-cascadehttpsgohugoiocontent-managementfront-matterfront-matter-cascade">&lt;a href="https://gohugo.io/content-management/front-matter/#front-matter-cascade">Front Matter Cascade&lt;/a>&lt;/h1>
&lt;p>Any node or section can pass down to descendents a set of Front Matter values as long as defined underneath the reserved cascade Front Matter key.&lt;/p>
&lt;p>&lt;strong>Example&lt;/strong>
In &lt;code>content/blog/_index.md&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="color:#66d9ef">cascade&lt;/span>:
&lt;span style="color:#66d9ef">banner&lt;/span>: images/typewriter.jpg
&lt;span style="color:#66d9ef">title&lt;/span>: Blog
&lt;/code>&lt;/pre>&lt;/div>&lt;p>With the above example the Blog section page and its descendents will return &lt;code>images/typewriter.jpg&lt;/code> when &lt;code>.Params.banner&lt;/code> is invoked unless:&lt;/p>
&lt;ul>
&lt;li>Said descendent has its own &lt;code>banner&lt;/code> value set&lt;/li>
&lt;li>Or a closer ancestor node has its own &lt;code>cascade.banner&lt;/code> value set.&lt;/li>
&lt;/ul>
&lt;h2 id="click-herehttpsgohugoiocontent-managementfront-matterorder-content-through-front-matter-content-above-is-enough-to-continue-read-on-original-page">&lt;strong>&lt;a href="https://gohugo.io/content-management/front-matter/#order-content-through-front-matter" title="content above is enough">click here&lt;/a> to continue read on original page&lt;/strong>&lt;/h2>
&lt;p>Order Content Through Front Matter&lt;br>
Override Global Markdown Configuration&lt;br>
Front Matter Format Specs&lt;br>
See Also&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://gohugo.io/content-management/archetypes/">Archetypes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://gohugo.io/templates/data-templates/">Data Templates&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://gohugo.io/getting-started/code-toggle/">Code Toggle&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://gohugo.io/getting-started/configuration/">Configure Hugo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://gohugo.io/content-management/taxonomies/">Taxonomies&lt;/a>&lt;/li>
&lt;/ul>
- //wmillers.github.io/document/front-matter-of-hugo/ - wmillers</description></item><item><title>Universal Post Title</title><link>//wmillers.github.io/posts/my-first-post/</link><pubDate>Tue, 30 Jun 2020 07:43:07 +0800</pubDate><guid>//wmillers.github.io/posts/my-first-post/</guid><description>源 //wmillers.github.io/posts/my-first-post/ -&lt;blockquote>
&lt;p>&lt;code>Used for test&lt;/code>&lt;br>
&lt;strong>May contains bugs&lt;/strong>&lt;br>
about&lt;/p>
&lt;/blockquote>
&lt;p>1️⃣😄&lt;br>
&lt;a href="https://www.webfx.com/tools/emoji-cheat-sheet/">Emoji Cheetsheet&lt;/a>&lt;/p>
&lt;p>When $a \ne 0$, there are two solutions to (ax^2 + bx + c = 0) and they are
$$x = {-b \pm \sqrt{b^2-4ac} \over 2a}.$$&lt;/p>
&lt;h1 id="internal-params-like-summary-will-cause-summary-error">&lt;strong>Internal params&lt;/strong> (like .Summary) WILL CAUSE SUMMARY ERROR&lt;/h1>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#a6e22e">A&lt;/span> &lt;span style="color:#a6e22e">bunch&lt;/span> &lt;span style="color:#a6e22e">of&lt;/span> &lt;span style="color:#a6e22e">code&lt;/span> &lt;span style="color:#a6e22e">here&lt;/span> &lt;/code>&lt;/pre>&lt;/div>
&lt;p>render of &lt;strong>`code`&lt;/strong> bug: ` code `&lt;/p>
&lt;pre>&lt;code>render of **\`code\`** bug: \` code \`
&lt;/code>&lt;/pre>&lt;blockquote>
&lt;p>Note that table should inside empty lines&lt;/p>
&lt;blockquote>
&lt;/blockquote>
&lt;p>&amp;lt;Empty&amp;gt;
|1|2|
|-|-|
|fail|-|
&amp;lt;Empty&amp;gt;&lt;/p>
&lt;/blockquote>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>1&lt;/th>
&lt;th>2&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>fail&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>tags&lt;/strong>
&lt;ul>
&lt;li>git&lt;/li>
&lt;li>github&lt;/li>
&lt;li>ssh&lt;/li>
&lt;li>markdown&lt;/li>
&lt;li>cheetsheet&lt;/li>
&lt;li>tutorial&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>categories&lt;/strong>
&lt;ul>
&lt;li>test&lt;/li>
&lt;li>archive&lt;/li>
&lt;li>undone&lt;/li>
&lt;li>finished&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>section&lt;/strong> basic type of an post, shows usage of a post, like:
&lt;ul>
&lt;li>&lt;code>document&lt;/code> collect of documents&lt;/li>
&lt;li>&lt;code>posts&lt;/code> default section&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>flow
st=&amp;gt;start: Start
op=&amp;gt;operation: Your Operation
cond=&amp;gt;condition: Yes or No?
e=&amp;gt;end
st-&amp;gt;op-&amp;gt;cond
cond(yes)-&amp;gt;e
cond(no)-&amp;gt;op
This document is originated from markdownguide, converted from html to markdown by aspose, and fix format by myself. Get Started Cheat Sheet Basic Syntax Extended Syntax Tools Book Markdown Cheat
2020-07-01    
This document is originated from markdownguide, converted from html to markdown by aspose, and fix format by myself. Get Started Cheat Sheet Basic Syntax Extended Syntax Tools Book Markdown Cheat
2020-07-01    
This document is originated from markdownguide, converted from html to markdown by aspose, and fix format by myself. Get Started Cheat Sheet Basic Syntax Extended Syntax Tools Book Markdown Cheat
2020-07-01    
This document is originated from markdownguide, converted from html to markdown by aspose, and fix format by myself. Get Started Cheat Sheet Basic Syntax Extended Syntax Tools Book Markdown Cheat
2020-07-01    &lt;/p>
- //wmillers.github.io/posts/my-first-post/ - wmillers</description></item><item><title>T1</title><link>//wmillers.github.io/test/t/</link><pubDate>Wed, 01 Jan 2020 01:01:01 +0800</pubDate><guid>//wmillers.github.io/test/t/</guid><description>源 //wmillers.github.io/test/t/ -- //wmillers.github.io/test/t/ - wmillers</description></item><item><title>T1</title><link>//wmillers.github.io/test/t4564/</link><pubDate>Wed, 01 Jan 2020 01:01:01 +0800</pubDate><guid>//wmillers.github.io/test/t4564/</guid><description>源 //wmillers.github.io/test/t4564/ -- //wmillers.github.io/test/t4564/ - wmillers</description></item><item><title>T1</title><link>//wmillers.github.io/test/t629/</link><pubDate>Wed, 01 Jan 2020 01:01:01 +0800</pubDate><guid>//wmillers.github.io/test/t629/</guid><description>源 //wmillers.github.io/test/t629/ -- //wmillers.github.io/test/t629/ - wmillers</description></item><item><title>T1</title><link>//wmillers.github.io/test/t7183/</link><pubDate>Wed, 01 Jan 2020 01:01:01 +0800</pubDate><guid>//wmillers.github.io/test/t7183/</guid><description>源 //wmillers.github.io/test/t7183/ -- //wmillers.github.io/test/t7183/ - wmillers</description></item></channel></rss>